'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.formatValidationError = exports.registerMJRule = exports.rulesCollection = undefined;

var _concat = require('lodash/concat');

var _concat2 = _interopRequireDefault(_concat);

var _filter = require('lodash/filter');

var _filter2 = _interopRequireDefault(_filter);

var _values = require('lodash/values');

var _values2 = _interopRequireDefault(_values);

var _ruleError = require('./rules/ruleError');

var _ruleError2 = _interopRequireDefault(_ruleError);

var _MJMLRulesCollection = require('./MJMLRulesCollection');

var _MJMLRulesCollection2 = _interopRequireDefault(_MJMLRulesCollection);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }

exports.rulesCollection = _MJMLRulesCollection2.default;
exports.registerMJRule = _MJMLRulesCollection.registerMJRule;
var formatValidationError = exports.formatValidationError = _ruleError2.default;

var validateNode = function validateNode(element) {
  var children = element.children;


  var errors = _concat2.default.apply(undefined, [errors].concat(_toConsumableArray((0, _values2.default)(_MJMLRulesCollection2.default).map(function (rule) {
    return rule(element);
  }))));

  if (children && children.length > 0) {
    errors = _concat2.default.apply(undefined, [errors].concat(_toConsumableArray(children.map(function (child) {
      return validateNode(child);
    }))));
  }

  return (0, _filter2.default)(errors);
};

exports.default = validateNode;